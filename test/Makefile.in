top_srcdir = @top_srcdir@
srcdir = @srcdir@
prefix = @prefix@

SILENCE = @

#---- Outputs ----#
COMPONENT_NAME = BookCode
TARGET_LIB = \
	lib/lib$(COMPONENT_NAME).a
	
TEST_TARGET = \
	$(COMPONENT_NAME)_tests

#--- Inputs ----#
PROJECT_HOME_DIR = .
ifeq "$(CPPUTEST_HOME)" ""
    CPPUTEST_HOME = ../CppUTest
endif
CPP_PLATFORM = g++

#CFLAGS are set to override malloc and free to get memory leak detection in C programs
CFLAGS = -DUT_MALLOC_OVERRIDES_ENABLED -Dmalloc=cpputest_malloc -Dfree=cpputest_free
CPPFLAGS = -g -Wall -DUT_MALLOC_OVERRIDES_ENABLED

SRC_DIRS = \
	c_src/utils \
	c_src/parser \
	c_src/erl \
	c_src/babysitter \
	c_src/bin

TEST_SRC_DIRS = \
	test/tests \
	test/mocks

INCLUDE_DIRS = \
	./ \
	test/mocks \
	SRC_DIRS

#Flags to pass to ld
LDFLAGS +=
LD_LIBRARIES += -lstdc++

include $(CPPUTEST_HOME)/build/ComponentMakefile
